<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- namespace 명은 dao 와 일치하게 작성하면 됨 -->
<mapper namespace="com.sjc.system.code.CodeMapper">

    <!-- 캐시 설정 -->
    <cache eviction="LRU"
        flushInterval="86400000"
        size="1000"
        readOnly="true"
        blocking="true" />

    <!-- 캐시 설정
        eviction : LRU 캐시 전략
        flushInterval : 24시간
        size : 최대 1000개 항목까지 캐시
        readOnly : 읽기 전용 캐시
        blocking : 캐시가 가득 차면 다른 스레드는 대기
    -->



    <!-- 기본 코드리스트 조회 -->
    <select id="getCodeList" resultType="CodeVo" parameterType="CodeVo">
        select code, cd, code_desc, code_ord, attr_1 as attr1
            , attr_2 as attr2, attr_3 as attr3, attr_4 as attr4, attr_5 as attr5
            , use_yn ,gen_by, gen_dt, mdfy_by, mdfy_dt
        from t_code_info TCI
        <where>
            <if test='code != null and !"".equals(code)'>
                and code = #{code}
            </if>
            <if test='cd != null and !"".equals(cd)'>
                and cd = #{cd}
            </if>
            <if test='use_yn != null and !"".equals(use_yn)'>
                and use_yn = #{use_yn}
            </if>
        </where>
    </select>

    <update id="updateCode" flushCache="true">
        update t_code_info
        set code_desc = #{code_desc}
            , code_ord  = #{code_ord}
            , attr1     = #{attr1}
            , attr2     = #{attr2}
            , attr3     = #{attr3}
            , attr4     = #{attr4}
            , attr5     = #{attr5}
            , use_yn    = #{use_yn}
            , mdfy_by   = 'test'
            , mdfy_dt   =  now()
       where code = #{code}
        <if test='cd != null and !"".equals(cd)'>
            and cd = #{cd}
        </if>
    </update>
</mapper>
